<script type="module">
export class workshopTools extends window.HTMLElement {
  connectedCallback() {
    this.i = 0;
    while (this.i < 4) {
      this.createParas();
      this.createParas();
      this.createParas();
      this.i += 1;
    }
  }

  createParas() {
    const sentences = [
      "Donec rutrum congue leo eget malesuada. Donec sollicitudin molestie malesuada. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec velit neque, auctor sit amet aliquam vel, ullamcorper sit amet ligula. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec velit neque, auctor sit amet aliquam vel, ullamcorper sit amet ligula. Proin eget tortor risus. Curabitur arcu erat, accumsan id imperdiet et, porttitor at sem. Vivamus magna justo, lacinia eget consectetur sed, convallis at tellus.",
      "Cras ultricies ligula sed magna dictum porta. Praesent sapien massa, convallis a pellentesque nec, egestas non nisi. Cras ultricies ligula sed magna dictum porta. Curabitur aliquet quam id dui posuere blandit. Nulla porttitor accumsan tincidunt. Mauris blandit aliquet elit, eget tincidunt nibh pulvinar a. Curabitur non nulla sit amet nisl tempus convallis quis ac lectus. Cras ultricies ligula sed magna dictum porta.",
      "Curabitur aliquet quam id dui posuere blandit. Quisque velit nisi, pretium ut lacinia in, elementum id enim. Proin eget tortor risus. Cras ultricies ligula sed magna dictum porta. Mauris blandit aliquet elit, eget tincidunt nibh pulvinar a. Curabitur non nulla sit amet nisl tempus convallis quis ac lectus. Pellentesque in ipsum id orci porta dapibus. Nulla quis lorem ut libero malesuada feugiat.",
      "Vivamus suscipit tortor eget felis porttitor volutpat. Nulla porttitor accumsan tincidunt. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec velit neque, auctor sit amet aliquam vel, ullamcorper sit amet ligula. Donec rutrum congue leo eget malesuada. Donec sollicitudin molestie malesuada. Quisque velit nisi, pretium ut lacinia in, elementum id enim. Sed porttitor lectus nibh. Vivamus suscipit tortor eget felis porttitor volutpat.",
      "Pellentesque in ipsum id orci porta dapibus. Praesent sapien massa, convallis a pellentesque nec, egestas non nisi. Quisque velit nisi, pretium ut lacinia in, elementum id enim. Vivamus magna justo, lacinia eget consectetur sed, convallis at tellus. Curabitur aliquet quam id dui posuere blandit. Cras ultricies ligula sed magna dictum porta. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus suscipit tortor eget felis porttitor volutpat."
    ];

    sentences.forEach((sentence) => {
      const para = document.createElement("p");
      para.innerHTML = sentence;
      this.appendChild(para);
    });
  }
}

window.customElements.define("workshop-tools", workshopTools);
</script>
<workshop-tools></workshop-tools>
<script type="module">
var styles = "/* Back to top button */\ncagov-back-to-top .back-to-top {\n  position: fixed;\n  z-index: 99999;\n  right: -100px;\n  font-size: var(--body-text, 1.125rem);\n  padding: 10px 10px 10px 10px;\n  bottom: 50px;\n  opacity: 0;\n  visibility: hidden;\n  color: var(--primary-color, #004abc);\n  border: 1px solid var(--primary-color, #004abc);\n  border-radius: 5px 0px 0px 5px;\n  text-decoration: none;\n  cursor: pointer;\n  transition: all 0.5s ease;\n  background-color: #fff;\n  box-shadow: 0px 0px 4px rgba(0, 0, 0, 0.25);\n}\n@media (max-width: 768px) {\n  cagov-back-to-top .back-to-top {\n    font-size: var(--body-text-mobile, 1rem);\n    padding: 8px 8px 8px 8px;\n  }\n}\ncagov-back-to-top .back-to-top:hover {\n  color: var(--primary-dark-color, #003484);\n  border: 1px solid var(--primary-dark-color, #003484);\n  background-color: var(--gray-100, #f9f9fa);\n}\ncagov-back-to-top .back-to-top:hover svg path {\n  fill: var(--primary-dark-color, #003484);\n}\ncagov-back-to-top .back-to-top:focus {\n  outline: 2px solid var(--highlight-color, #fec02f);\n}\ncagov-back-to-top .back-to-top svg {\n  width: 16px;\n  position: relative;\n  top: 3px;\n}\ncagov-back-to-top .back-to-top svg path {\n  fill: var(--primary-color, #004abc);\n}\ncagov-back-to-top .back-to-top.is-visible {\n  opacity: 1;\n  visibility: visible;\n  display: inline;\n  right: 0;\n}\n\n/*# sourceMappingURL=index.css.map */\n";

class CaGovBackToTop extends window.HTMLElement {
  static get observedAttributes() {
    return ['data-hide-after', 'data-label'];
  }

  constructor() {
    super();
    // Support additional options
    const defaultOptions = {
      parentSelector: 'cagov-back-to-top',
      onLoadSelector: 'body',
      scrollBottomThreshold: 10,
      scrollAfterHeight: 400, // Pixel height (after which, go-to-top behavior will start)
    };
    this.options = {
      ...defaultOptions,
      label: this.dataset.label || 'Back to top',
      hideAfter: Number(this.dataset.hideAfter) || 7000, // 7 second initial display. (milliseconds)
    };
    this.state = {
      lastScrollTop: 0,
      timer: null,
    };
  }

  connectedCallback() {
    // Load go-to-top button
    document.querySelector(this.options.onLoadSelector).onload =
      this.addGoToTopButton();

    // If a user scrolls down the page for more than the "scrollAfterHeight" (example: 400px),
    // activate back to top button. Otherwise, keep it invisible.
    window.addEventListener(
      'scroll',
      CaGovBackToTop.debounce(() => {
        // 1 second debounce delay
        this.scrollToTopHandler();
      }, 200),
      false,
    );

    // Reaching botton of the screen
    window.onscroll = CaGovBackToTop.debounce(() => {
      this.checkScrolledToBottom();
    }, 200);
  }

  checkScrolledToBottom() {
    const { timer } = this.state;
    const returnTopButton = document.querySelector('.back-to-top');
    if (window.innerHeight + window.scrollY >= document.body.offsetHeight) {
      returnTopButton.classList.add('is-visible');
      returnTopButton.removeAttribute('aria-hidden');
      returnTopButton.removeAttribute('tabindex');
      clearTimeout(timer);
    }
  }

  // Returns a function, that, as long as it continues to be invoked, will not
  // be triggered. The function will be called after it stops being called for
  // N milliseconds. If `immediate` is passed, trigger the function on the
  // leading edge, instead of the trailing.
  static debounce(func, wait, immediate) {
    let timeout;
    return (...args) => {
      const context = this;
      const later = () => {
        timeout = null;
        if (!immediate) func.apply(context, ...args);
      };
      const callNow = immediate && !timeout;
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
      if (callNow) func.apply(context, ...args);
    };
  }

  attributeChangedCallback(name, oldValue, newValue) {
    if (name === 'data-hide-after') {
      this.options.hideAfter = Number(newValue);
    }
    if (name === 'data-label') {
      this.options.label = newValue;
      if (document.querySelector('.back-to-top') !== null) {
        document.querySelector('.back-to-top').innerHTML = this.options.label;
      }
    }
  }

  scrollToTopHandler() {
    const container = document.querySelector(this.options.parentSelector);
    const { lastScrollTop } = this.state;
    let { timer } = this.state;
    const returnTopButton = document.querySelector('.back-to-top');
    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

    if (scrollTop > lastScrollTop) {
      // Downscroll code
      returnTopButton.classList.remove('is-visible');
      returnTopButton.setAttribute('aria-hidden', 'true');
      returnTopButton.setAttribute('tabindex', '-1');
    } else if (
      container.scrollTop >= this.options.scrollAfterHeight ||
      document.documentElement.scrollTop >= this.options.scrollAfterHeight
    ) {
      // Upscroll code
      if (timer !== null) {
        clearTimeout(timer);
      }
      returnTopButton.classList.add('is-visible');
      returnTopButton.removeAttribute('aria-hidden');
      returnTopButton.removeAttribute('tabindex');

      timer = setTimeout(() => {
        returnTopButton.classList.remove('is-visible');
        returnTopButton.setAttribute('aria-hidden', 'true');
        returnTopButton.setAttribute('tabindex', '-1');
      }, this.options.hideAfter); // Back to top removes itself after 2 sec of inactivity
    } else {
      // Bottom of the page
      returnTopButton.classList.remove('is-visible');
      returnTopButton.setAttribute('aria-hidden', 'true');
      returnTopButton.setAttribute('tabindex', '-1');
    }

    this.state.lastScrollTop = scrollTop <= 0 ? 0 : scrollTop; // For Mobile or negative scrolling
  }

  // Insert swg icon
  static addStyle(element) {
    const svg = document.createElement('span');
    svg.setAttribute('aria-hidden', 'true');
    svg.innerHTML = `
      <svg version="1.1" x="0px" y="0px" width="21px" height="16px" viewBox="0 0 21 16" style="enable-background:new 0 0 21 16;" xml:space="preserve"><path d="M5.2,10.8l5.3-5.3l5.3,5.3c0.4,0.4,0.9,0.4,1.3,0c0.4-0.4,0.4-0.9,0-1.3l-5.9-5.9c-0.2-0.2-0.4-0.3-0.6-0.3S10,3.5,9.8,3.6 L3.9,9.5c-0.4,0.4-0.4,0.9,0,1.3C4.3,11.2,4.8,11.2,5.2,10.8z"/></svg> 
      `;
    element.insertBefore(svg, element.firstChild);
  }

  // Create go-to-top button
  addGoToTopButton() {
    // Create a new go-to-top span element with class "back-to-top"
    const container = document.querySelector(this.options.parentSelector);

    const returnTop = document.createElement('button');
    returnTop.classList.add('back-to-top');
    // returnTop.classList.add(options.classes);
    // Does not need to be accessible.
    // Screen Reader users have other options to get to the top.
    returnTop.setAttribute('aria-hidden', 'true');
    returnTop.setAttribute('tabindex', '-1');
    // Add some text to the go-to-top button
    const returnContent = document.createTextNode(this.options.label);

    // Append text to the go-to-top span
    returnTop.appendChild(returnContent);
    CaGovBackToTop.addStyle(returnTop);
    // Add the newly created element and its content into main tag
    container.append(returnTop);

    // Add on-click event
    returnTop.addEventListener('click', () => this.goToTopFunction());
  }

  goToTopFunction() {
    document.querySelector(this.options.onLoadSelector).scrollTop = 0; // For Safari
    // document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
    window.scroll({ top: 0, behavior: 'smooth' });
  }
}

window.customElements.define('cagov-back-to-top', CaGovBackToTop);

const style = document.createElement('style');
style.textContent = styles;
document.querySelector('head').appendChild(style);

export { CaGovBackToTop };
</script>
<cagov-back-to-top data-hide-after="7000" data-label="Back to top">
</cagov-back-to-top>